---
alwaysApply: false
---

# ユビキタス言語定義チェックルール - 完全版

## 命令書

あなたは、ドメイン駆動設計（DDD）の専門家であり、ユビキタス言語の品質を監査するシニアレビューアです。
以下の「ユビキタス言語定義チェックルール」に厳密に従い、ユーザーが指定したCSVファイルを分析し、「出力フォーマット」に従って品質チェックレポートを生成してください。

---

## 1. 概要

このルールは、**ユビキタス言語の定義内容自体の品質**をチェックするためのものです。コードやドキュメントでの用語使用チェックではなく、ユビキタス言語CSVファイル自体の健全性を保証します。

---

## 2. 対象ファイル

**チェック対象**: `docs/` フォルダ配下でファイル名に「ユビキタス」が含まれるCSVファイル

- **パターン**: `docs/**/*ユビキタス*.csv`
- **例**: `docs/Ops1ユビキタス言語 239800242d348012a97ddac295bd9ce0.csv`

---

## 3. CSVファイルの期待構造

ユビキタス言語CSVは以下のカラムを持つことを前提としています：

| カラム名 | 必須 | 説明 |
|---------|------|------|
| 論理名 | ✅ | ドメイン用語の正式名称 |
| 物理名 | 推奨 | データベースカラム名など物理的な名称 |
| 定義 | ✅ | 用語の意味と説明 |
| 構成要素（必須） | 任意 | この概念を構成する必須要素 |
| 構成要素（任意） | 任意 | この概念を構成する任意要素 |
| ステータス | ✅ | 安定 / 修正・議論中 / 未着手 / 保留 |
| 最終更新日時 | 推奨 | - |
| 最終更新者 | 推奨 | - |

---

## 4. チェック項目

以下の4つの観点でチェックを実施してください。

---

### 4-1. 用語の重複や矛盾のチェック

#### チェック内容

- [ ] 同じ論理名が複数存在しないか
- [ ] 同じ物理名が複数存在しないか（空白を除く）
- [ ] 同義語が別々の用語として登録されていないか
- [ ] 一つの用語が複数の異なる概念を指していないか
- [ ] 相互参照している用語の定義に矛盾がないか

#### 🔴 重大な違反例

1. **論理名の重複**
   - 例: 論理名「（まだ名前がない）」が2件存在
   - 影響: ユビキタス言語として参照不可能、CSV上で一意に特定できない

2. **相互参照の矛盾・循環参照**
   - 例: 「企業」と「本社」がお互いを参照し合い、使い分けが不明確
   - 影響: どちらを正式用語として使うべきか不明

3. **同一概念に対する複数の用語**
   - 例: 同じ審査プロセスに「dip社内登録審査」と「共通企業マスタ登録審査」の2つの名称
   - 影響: 用語の重複による混乱

#### 対応方法

1. **重複する論理名には一意の名称を付与**
   - 提案例: 「別法人同一ブランド」「同一法人複数ブランド」など

2. **同義語は一つに統一し、他方は削除または別名として明記**
   - より明確な名称を正式用語とする
   - 削除する用語は定義内に「別名」として記載することも検討

3. **相互参照する用語は、どちらを正式用語とするか議論して確定**
   - Option A: 一方を正式用語とし、他方は削除または別名扱い
   - Option B: 使い分けルールを明確化

4. **物理名の重複は、別テーブル/別概念であれば許容される場合もあるため注意深く判断**
   - 同じ物理名でも異なるテーブルやコンテキストであれば問題ない場合がある

---

### 4-2. 定義の曖昧さや不明瞭さのチェック

#### チェック内容

- [ ] 定義が空白または極めて短い用語がないか（目安: 20文字未満）
- [ ] 「～のようなもの」「～など」といった曖昧な表現がないか
- [ ] 定義内に疑問形や「要確認」「議論中」が含まれていないか
- [ ] 外部リンク（Notion URLなど）のみで自己完結していない定義がないか
- [ ] 構成要素が未定義の用語がないか（特にValueObject/Entityとなる概念）

#### ⚠️ 要改善例

1. **定義が完全に空白**
   - 例: 「ブランド」→ 定義が完全に空
   - 影響: 何を表す概念か全く不明、ユビキタス言語として使用不可能

2. **定義が不完全（要確認のみ）**
   - 例: 「本社マスタ」→「ops0の朝会で確認」のみ
   - 影響: 定義が実質的に存在しない

3. **曖昧な表現**
   - 例: 「組織」→「一まとまり」の意味が不明確
   - 影響: 具体的な境界や範囲が定義されていない

4. **疑問形・未確定コメントが残存**
   - 例: 「個人事業主の場合の取り扱いが要確認」
   - 影響: 定義が確定していない、実装時に判断できない

5. **外部リンク依存**
   - 例: 定義の大部分がNotion URLで、CSV単体で理解不可能
   - 影響: CSV単体で定義を理解できない

#### 対応方法

1. **空白の定義は最優先で記述または削除**
   - 定義を記述できない場合は、その用語自体が不要な可能性を検討

2. **疑問形やコメントは議論を実施し、確定した定義に更新**
   - チームで議論の場を設ける
   - 確定後、定義を明確な文章で記述

3. **外部リンクは補足情報として保持しつつ、定義文自体はCSV内で自己完結させる**
   - 良い例: 「事業所が物理的に存在する場所。都道府県、市区郡町村、町大字通称、字丁目、番地番号、建物名部屋番号を含む」
   - URLは別カラムに移動するか、補足として括弧内に記載

4. **曖昧な表現（「～のようなもの」「任意の」など）は、具体的な条件や範囲を明記**
   - 「一まとまり」→「本社をルートとする事業所の階層構造全体」など

5. **ValueObject/Entityとして実装予定の用語は構成要素を明記**
   - 「構成要素（必須）」「構成要素（任意）」カラムを活用

---

### 4-3. 未定義項目の洗い出し

#### チェック内容

- [ ] 物理名が空白の用語を確認（特に「安定」ステータスの用語）
- [ ] ステータスが「未着手」「保留」の用語の現状確認
- [ ] 「修正・議論中」が長期間放置されていないか（目安: 1ヶ月以上）
- [ ] 構成要素（必須）が空白の用語を確認（集約やエンティティの候補）
- [ ] 最終更新日時が古い用語の見直し（目安: 6ヶ月以上更新なし）

#### 📊 定期モニタリング指標

| 指標 | 目標値 | 備考 |
|------|--------|------|
| **物理名未定義率** | < 20% | Phase1実装予定の用語は必須 |
| **「修正・議論中」率** | < 20% | 全体の安定性を示す指標 |
| **「未着手」放置期間** | < 1ヶ月 | 放置期間が長い場合は削除を検討 |
| **定義が空白の用語** | 0件 | 最優先で解消すべき |

#### ⚠️ 要改善例

1. **「安定」ステータスで物理名が未定義**
   - 例: `comp`, `法人`, `法人名`, `企業名` など
   - 影響: Infrastructure層での実装時に物理名が必要

2. **「修正・議論中」が多数**
   - 例: 全体の45%が「修正・議論中」
   - 影響: 定義の安定性が低い、実装を進められない

3. **「未着手」が長期間放置**
   - 例: 論理名が未定義（「（まだ名前がない）」）
   - 影響: 用語として機能していない

#### 対応方法

1. **実装予定のフェーズ（Phase1/Phase2/Phase3）を明確にする**
   - Phase1: 即座に実装予定の用語
   - Phase2: 2～3ヶ月以内に実装予定の用語
   - Phase3: 将来的に実装予定の用語

2. **Phase1実装予定の用語は物理名を最優先で定義**
   - 特に重要概念（comp, 事業所関連など）は必須

3. **「修正・議論中」は月次で議論の場を設け、確定を進める**
   - 月次で20件ずつ確定する計画を立てる
   - 優先度の高い用語から順に確定

4. **「未着手」は削除するか、「保留」理由を明記**
   - 削除予定の用語は即座に削除
   - 保留する場合は理由を定義に記載

5. **長期間更新がない用語は、現在も有効か確認**
   - 6ヶ月以上更新がない用語は見直し対象

---

### 4-4. 用語間の関連性や階層構造のチェック

#### チェック内容

- [ ] 親子関係の用語セットが整合しているか（例: 親事業所 ⇔ 子事業所）
- [ ] 識別子とその対象オブジェクトのステータスが一致しているか（例: 事業所ID ⇔ 事業所）
- [ ] 集約候補の用語と構成要素の関係が明確か
- [ ] プロダクト固有用語と共通用語の区別が明確か
- [ ] 外部システム用語の変換ルールが定義されているか

#### ⚠️ 要改善例

1. **親子関係の用語セットでステータスが不整合**
   - 例: 「親事業所」は安定だが「子事業所」は議論中
   - 影響: 階層構造の実装時に混乱

2. **識別子とオブジェクトのペアが不整合**
   - 例: 「compNo」は議論中だが「comp」は安定
   - 影響: 識別子の定義が不安定

3. **プロダクト固有用語と共通用語の境界が不明確**
   - 例: バイトル/スポバ/OBIC用語が混在
   - 影響: どのプロダクトで使用する用語か不明

4. **外部システム用語の変換ルールが未定義**
   - 例: 「契約先CD」「請求先CD」の自システムへの変換ルールが未定義
   - 影響: 腐敗防止層での実装時に判断が必要

#### 対応方法

1. **階層構造を表す用語セットは同時に確定する**
   - 親子関係: 親事業所 ⇔ 子事業所
   - 兄弟関係: 兄弟事業所 ⇔ 兄弟事業所ID
   - 全体と部分: 事業所 ⇔ 本社 / 拠点

2. **識別子とオブジェクトは必ずペアで「安定」ステータスにする**
   - 例: 事業所 ⇔ 事業所ID
   - 例: comp ⇔ compNo
   - 片方だけ「安定」にしない

3. **プロダクト固有用語には明示的にタグ付け**
   - 方法1: 論理名にプレフィックス（例: `[バイトル] comp`）
   - 方法2: CSVに「適用プロダクト」カラムを追加
   - 方法3: 定義の冒頭に明記（例: 「・バイトルの用語」）

4. **外部システム用語には、自システムへの変換ルールを定義に含める**
   - 例: 「OBIC契約先CD → 共通企業マスタの事業所IDにマッピング」
   - 腐敗防止層での実装方針を明記

---

## 5. チェック実施タイミング

### 📅 定期チェックスケジュール

#### 毎週（新規追加時）
**対象**: 新規追加された用語  
**チェック内容**:
- 論理名の重複チェック
- 定義の記述チェック
- ステータスの妥当性チェック
- 必須カラム（論理名、定義、ステータス）の記入確認

**実施タイミング**: 用語追加から1週間以内

---

#### 月次（進捗確認）
**対象**: 「修正・議論中」「未着手」用語  
**チェック内容**:
- 議論が必要な用語のリストアップ
- 優先度付けと担当者アサイン
- 物理名未定義率のモニタリング
- 長期間放置されている用語の確認

**目標**: 月次で20件の用語を「安定」に移行

---

#### 四半期（包括チェック）
**対象**: 全用語  
**チェック内容**:
- 4つのチェック項目すべての実施
- 詳細レポートの生成
- 改善計画の策定
- 品質指標のトレンド分析

**成果物**: 包括的な品質チェックレポート

---

## 6. CSV品質向上のためのベストプラクティス

### ✅ 良い定義の例

#### 例1: comp

**論理名**: comp  
**物理名**: (空白) ※Phase1で定義予定  
**定義**: バイトルで使われる企業の案件管理単位。採用案件を管理・参照しやすくするために、複数の求人案件をひとつの構成単位（＝Composition）として束ねたグループに付ける識別番号。本社や拠点といった単位にとらわれず、営業やクライアントが管理しやすい任意の範囲で作成できる。  
**ステータス**: 安定

**良い点**:
- ✅ 自己完結した定義（外部リンクに依存していない）
- ✅ 業務的な目的が明確（「採用案件を管理・参照しやすくするために」）
- ✅ 制約や範囲が明記されている（「任意の範囲で作成できる」）
- ✅ 語源が説明されている（「Composition」）

---

#### 例2: 事業所所在地

**論理名**: 事業所所在地  
**物理名**: office_address  
**定義**: 事業所が物理的に存在する場所。都道府県、市区郡町村、町大字通称、字丁目、番地番号、建物名部屋番号を含む。  
**構成要素（必須）**: 事業所都道府県, 事業所市区郡町村  
**構成要素（任意）**: 事業所町大字通称, 事業所字丁目, 事業所番地番号, 事業所建物名部屋番号  
**ステータス**: 安定

**良い点**:
- ✅ 構成要素が明確に定義されている
- ✅ 必須要素と任意要素が区別されている
- ✅ 物理名が定義されている

---

### ❌ 悪い定義の例

#### 例1: ブランド

**論理名**: ブランド  
**物理名**: (空白)  
**定義**: (空白)  
**ステータス**: 未着手

**問題点**:
- ❌ 定義が空白 → 何を表す概念か不明
- ❌ 未着手のまま放置
- ❌ 使用不可能な状態

**改善策**: 定義を記述するか、不要であれば削除

---

#### 例2: 本社マスタ

**論理名**: 本社マスタ  
**物理名**: (空白)  
**定義**: ops0の朝会で確認  
**ステータス**: 未着手

**問題点**:
- ❌ 定義が不完全（確認待ちの状態）
- ❌ CSV単体で意味が分からない
- ❌ 実装できない状態

**改善策**: ops0朝会で確認後、正式な定義を記述

---

#### 例3: 組織

**論理名**: 組織  
**物理名**: organization  
**定義**: 本社・拠点の階層構造を一まとめにしたもの。本社とその本社より下の階層の事業所をまとめた単位。  
**ステータス**: 保留

**問題点**:
- ⚠️ 「一まとまり」が曖昧
- ⚠️ 具体的な境界が不明確
- ⚠️ 保留の理由が記載されていない

**改善策**: 
- 「一まとまり」→「本社をルートとする事業所の階層構造全体」
- 保留理由を定義に追記

---

## 実行指示

上記「ユビキタス言語定義チェックルール」に基づき、ユーザーが指定したCSVファイルの内容を分析し、以下の「出力フォーマット」に従って詳細なレポートを生成してください。

### 出力先

チェック結果は以下のファイルに保存してください：

**ファイルパス**: `docs/temp-ubiquitous-language-check.md`

**ファイル出力の手順**:
1. `docs/temp-ubiquitous-language-check.md` が既に存在するか確認
2. 存在する場合は、ユーザーに上書き確認を行う
   - 確認メッセージ例: 「`docs/temp-ubiquitous-language-check.md` が既に存在します。上書きしてよろしいですか？」
3. ユーザーの承認後、またはファイルが存在しない場合は、新規作成
4. チェック結果をマークダウン形式で記述
5. ファイル保存後、ユーザーにファイルパスを通知

---

## 出力フォーマット

チェック結果を以下のマークダウン形式でレポートしてください：

出力ファイルの構造は以下の通りです：

```markdown
# ユビキタス言語定義 品質チェックレポート

**チェック対象ファイル**: `[CSVファイル名]`  
**チェック実施日時**: YYYY-MM-DD HH:MM:SS  
**チェック実施者**: AI (Cursor Rules)

---

## 📊 サマリー

| チェック項目 | 🔴 重大 | 🟠 要改善 | 💡 情報提供 |
|------------|--------|---------|-----------|
| 4-1. 用語の重複・矛盾 | X件 | Y件 | Z件 |
| 4-2. 定義の曖昧さ | X件 | Y件 | Z件 |
| 4-3. 未定義項目 | X件 | Y件 | Z件 |
| 4-4. 関連性・階層構造 | X件 | Y件 | Z件 |
| **合計** | **X件** | **Y件** | **Z件** |

---

## 🔴 重大な問題（即座に対応が必要）

各問題について以下の形式で記載：

### [4-X] 問題のタイトル

**該当行**: 行番号  
**チェック項目**: 4-X. チェック項目名  
**論理名**: `用語名`  
**物理名**: `physical_name` または (空白)  
**ステータス**: 安定 / 修正・議論中 / 未着手 / 保留

**CSV該当行**:
\`\`\`csv
行番号| 論理名,物理名,定義,構成要素（必須）,構成要素（任意）,ステータス,最終更新日時,最終更新者
\`\`\`

**問題内容**:
- 具体的な問題の説明

**影響度**: 🔴 最高 / 高 / 中

**推奨対応**:
1. 具体的な対応策
2. 修正案（該当する場合）

**対応期限**: 即日 / 1週間 / 2週間

---

## 🟠 要改善事項（短期的に対応が必要）

（上記と同様の形式で記載）

---

## 💡 情報提供（中長期的に改善を検討）

（上記と同様の形式で記載）

---

## 🎯 優先対応項目 TOP 10

| 優先度 | チェック項目 | 問題 | 該当用語（行） | 推奨アクション | 期限 |
|-------|------------|------|--------------|--------------|------|
| 🔴 1 | 4-X | [問題の種類] | [用語名] (行XX, YY) | [対応内容] | [期限] |
| 🔴 2 | 4-X | [問題の種類] | [用語名] (行XX) | [対応内容] | [期限] |
| ... | ... | ... | ... | ... | ... |

---

## 📋 推奨アクション

### 【即日～1週間】緊急対応
1. ✅ [チェック項目4-X] [問題の説明]（[用語名]、行XX-YY）
2. ✅ [チェック項目4-X] [問題の説明]（[用語名]、行XX）
   ...

### 【2週間～1ヶ月】短期対応
1. 📝 [チェック項目4-X] [問題の説明]（行XX, YY）
2. 📝 [チェック項目4-X] [問題の説明]（行XX）
   ...

### 【2～3ヶ月】中期対応
1. 📋 [チェック項目4-X] [問題の説明]
2. 📋 [チェック項目4-X] [問題の説明]
   ...

---

## 📊 品質指標

| 指標 | 現状 | 目標 | 評価 |
|------|------|------|------|
| 物理名未定義率 | X% (XX/XX件) | < 20% | 🔴/🟠/✅ |
| 「修正・議論中」率 | X% (XX/XX件) | < 20% | 🔴/🟠/✅ |
| 「未着手」率 | X% (XX/XX件) | < 5% | 🔴/🟠/✅ |
| 定義空白の用語 | X件 | 0件 | 🔴/🟠/✅ |
| 論理名重複 | X件 | 0件 | 🔴/🟠/✅ |

**総合評価**: 🔴 要改善 / 🟠 注意 / 🟡 良好 / ✅ 優秀

---

**レポート生成日**: YYYY-MM-DD  
**チェックルールバージョン**: 2.0
```

---

## 補足

### 評価基準

- **🔴 要改善**: 重大な問題が存在し、即座の対応が必要
- **🟠 注意**: 複数の要改善事項があり、計画的な対応が必要
- **🟡 良好**: 一部改善の余地はあるが、概ね良好
- **✅ 優秀**: 高品質で、継続的な維持が推奨される

### 影響度の判断基準

- **🔴 最高**: システムの実装を阻害する、またはビジネスに直接影響する
- **🔴 高**: 実装の判断ができない、または混乱を招く
- **🟠 中**: 品質低下や将来的な問題の原因となる
- **💡 低**: 改善が望ましいが、緊急性は低い

---

**このルールファイルの最終更新日**: 2025年10月19日  
**バージョン**: 2.0
